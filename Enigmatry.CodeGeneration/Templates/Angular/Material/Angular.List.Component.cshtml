@using Enigmatry.CodeGeneration
@using Enigmatry.CodeGeneration.Angular
@using Enigmatry.CodeGeneration.Templates.HtmlHelperExtensions.Angular
@using Enigmatry.CodeGeneration.Templates.HtmlHelperExtensions.TypeScript
@model Enigmatry.CodeGeneration.Configuration.List.ListComponentModel;
@inject CodeGeneratorOptions _options;
/* eslint-disable @@typescript-eslint/member-ordering */
/* eslint-disable max-len */
/* eslint-disable no-trailing-spaces */
import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnInit, Output, TemplateRef, ViewChild } from '@@angular/core';
import { CellTemplate, ColumnDef } from 'src/@@enigmatry/enigmatry-grid';
import { PagedData, PageEvent, SortEvent } from 'src/@@enigmatry/pagination';

import { @(Model.ComponentInfo.ModelType) } from '@_options.ApiClientTsImportPath';

@@Component({
  selector: '@Model.AngularComponentSelector(_options.ComponentPrefix)',
  templateUrl: './@(Model.AngularComponentFileName()).html',
  styleUrls: ['./@(Model.AngularComponentFileName()).scss'],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class @Model.AngularComponentName() implements OnInit {

  @@Input() data: PagedData@(Html.Raw($"<{Model.ComponentInfo.ModelType}>")) | null;
  @@Input() loading: boolean;

  @@Input() showPaginator = @Model.ShowPaginator.ToString().ToLower();
  @@Input() showFirstLastButtons = @Model.ShowFirstLastPageButtons.ToString().ToLower();
  @@Input() pageSizeOptions = @Html.JsArray(Model.PageSizeOptions);
  @@Input() hidePageSize = @Model.HidePageSize.ToString().ToLower();

  @@Input() rowSelectable = @Model.IsRowSelectable.ToString().ToLower();
  @@Input() multiSelectable = @Model.EnableMultiSelection.ToString().ToLower();

  @@Input() headerTemplate: TemplateRef@(Html.Raw("<any>")) | CellTemplate;
  @@Input() cellTemplate: TemplateRef@(Html.Raw("<any>")) | CellTemplate;

  @@Input() columns: ColumnDef[] = [];

  @@Output() pageChange = new EventEmitter@(Html.Raw("<PageEvent>"))();
  @@Output() sortChange = new EventEmitter@(Html.Raw("<SortEvent>"))();
  @@Output() selectionChange = new EventEmitter@(Html.Raw($"<{Model.ComponentInfo.ModelType}[]>"))();

  @Html.AllCustomCellTemplateViewChildRefs(Model.Columns)
  constructor() {}

  ngOnInit(): void {
    this.columns = @Html.CreateColumnDefs(Model.Columns);
  }
}
